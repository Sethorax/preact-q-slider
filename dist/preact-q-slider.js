function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("preact"),i=t(e),s=require("unistore/preact"),o=t(require("classnames")),r=require("preact-html-converter/browser"),n=t(require("unistore"));function p(t){return{setSlides:function(t,e){return{slides:e}},setGrabbingState:function(t,e){return{isGrabbing:e}},setGrabbedTrackOffset:function(t,e){return{grabbedTrackOffset:e}},setFadingState:function(t,e){return{isFading:e}},setCurrentSlide:function(t,e){return{lastSlide:t.currentSlide,currentSlide:e}}}}var a=function(){};a.getClientPosFromTouchOrMouseEvent=function(t,e){return void 0===e&&(e=!1),t.touches?e?t.touches[0].clientY:t.touches[0].clientX:e?t.clientY:t.clientX};var l=function(t){function i(){t.apply(this,arguments)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.componentWillMount=function(){this.grabbedStartingX=0},i.prototype.handleMouseTouchDown=function(t){if(!(this.props.slides.length<=this.props.slidesToShow)){var e=a.getClientPosFromTouchOrMouseEvent(t,this.props.vertical);this.grabbedStartingX=e,this.props.setGrabbingState(!0)}},i.prototype.handleMouseTouchMove=function(t){if(this.props.isGrabbing&&!(this.props.slides.length<=this.props.slidesToShow)){var e=a.getClientPosFromTouchOrMouseEvent(t,this.props.vertical),i=100*(this.grabbedStartingX-e)/this.props.getSliderWidth();this.props.setGrabbedTrackOffset(i)}},i.prototype.handleMouseTouchUp=function(){if(!(this.props.slides.length<=this.props.slidesToShow)){this.grabbedStartingX=0;var t=parseFloat(this.props.grabbedTrackOffset)/(100/parseInt(this.props.slidesToShow));0!==(t=t>0?Math.ceil(t):Math.floor(t))&&this.props.gotoSlide(this.props.currentSlide+t),this.props.setGrabbedTrackOffset(0),this.props.setGrabbingState(!1)}},i.prototype.render=function(){return e.h("div",{className:"q-slider__draggable-track",onMouseDown:this.handleMouseTouchDown.bind(this),onTouchStart:this.handleMouseTouchDown.bind(this),onMouseMove:this.handleMouseTouchMove.bind(this),onTouchMove:this.handleMouseTouchMove.bind(this),onMouseUp:this.handleMouseTouchUp.bind(this),onMouseOut:this.handleMouseTouchUp.bind(this),onTouchEnd:this.handleMouseTouchUp.bind(this)},this.props.children)},i}(i.Component),h=s.connect(["isGrabbing","grabbedTrackOffset","currentSlide","slides"],p)(l),d=function(t){function i(){t.call(this),this.state={currentSlideIndex:0,currentSlide:null,nextSlide:null,nextSlideIndex:-1}}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.componentWillMount=function(){this.onClickStartX=0,this.onClickStartY=0},i.prototype.handleSlideMouseTouchDown=function(t){this.onClickStartX=a.getClientPosFromTouchOrMouseEvent(t),this.onClickStartY=a.getClientPosFromTouchOrMouseEvent(t,!0)},i.prototype.handleSlideClick=function(t,e){this.onClickStartX===a.getClientPosFromTouchOrMouseEvent(t)&&this.onClickStartY===a.getClientPosFromTouchOrMouseEvent(t,!0)&&"function"==typeof this.props.onSlideClick&&this.props.onSlideClick(t,e)},i.prototype.renderSlidingTrack=function(){var t=this,i=100/this.props.slidesToShow,s=i*this.props.currentSlide*-1-this.props.grabbedTrackOffset;return e.h("div",{className:o("q-slider__track",{"q-slider__track_no-transition":this.props.isGrabbing}),style:{transform:this.props.vertical?"translate3d(0, "+s+"%, 0)":"translate3d("+s+"%, 0, 0)"}},this.props.slides.map(function(s,o){return e.h("div",{key:o,onMouseDown:t.handleSlideMouseTouchDown.bind(t),onTouchStart:t.handleSlideMouseTouchDown.bind(t),onClick:function(e){return t.handleSlideClick.bind(t)(e,o)},className:"q-slider__slide","data-slide-index":o,style:t.props.vertical?{height:i+"%"}:{width:i+"%"}},s)}))},i.prototype.componentWillMount=function(){this.fadeQueue=null,this.activeFadeSlide=0},i.prototype.componentDidMount=function(){this.props.fade&&this.setState({currentSlide:this.props.slides[this.props.currentSlide]})},i.prototype.componentDidUpdate=function(){var t=this;this.props.fade&&(this.props.currentSlide===this.state.currentSlideIndex||this.props.isFading||(this.state.nextSlideIndex!==this.props.currentSlide?this.setState({nextSlideIndex:this.props.currentSlide,nextSlide:this.props.slides[this.props.currentSlide]}):(this.props.setFadingState(!0),clearTimeout(this.fadeQueue),this.fadeQueue=setTimeout(function(){t.activeFadeSlide=0===t.activeFadeSlide?1:0,t.props.setFadingState(!1),t.setState({currentSlideIndex:t.state.nextSlideIndex,currentSlide:t.state.nextSlide})},this.props.fadeDuration))))},i.prototype.shouldComponentUpdate=function(t){return!1!==t.isFading||!0!==this.props.isFading},i.prototype.renderFadingTrack=function(){return e.h("div",{className:o("q-slider__track q-slider__track_fading-track",{"q-slider__track_fading-track_is-fading":this.props.isFading})},e.h("div",{className:o("q-slider__slide q-slider__slide_is-current",{"q-slider__slide_is-active":0===this.activeFadeSlide}),style:{zIndex:0===this.activeFadeSlide?2:1,opacity:0===this.activeFadeSlide&&this.props.isFading?0:1,transition:"opacity "+this.props.fadeDuration+"ms ease"}},0===this.activeFadeSlide?this.state.currentSlide:this.state.nextSlide),e.h("div",{className:o("q-slider__slide q-slider__slide_is-next",{"q-slider__slide_is-active":1===this.activeFadeSlide}),style:{zIndex:1===this.activeFadeSlide?2:1,opacity:1===this.activeFadeSlide&&this.props.isFading?0:1,transition:"opacity "+this.props.fadeDuration+"ms ease"}},1===this.activeFadeSlide?this.state.currentSlide:this.state.nextSlide))},i.prototype.render=function(){return 1===this.props.slidesToShow&&this.props.fade?this.renderFadingTrack():this.renderSlidingTrack()},i}(i.Component),c=s.connect(["slides","isGrabbing","currentSlide","lastSlide","grabbedTrackOffset","isFading"],p)(d),u=function(t){function s(){t.apply(this,arguments)}return t&&(s.__proto__=t),(s.prototype=Object.create(t&&t.prototype)).constructor=s,s.prototype.render=function(){var t=this.props.nextArrow?i.cloneElement(this.props.nextArrow,{onClick:this.props.onNextClick}):e.h("div",{className:"q-slider__arrow q-slider__arrow_next",onClick:this.props.onNextClick}),s=this.props.prevArrow?i.cloneElement(this.props.prevArrow,{onClick:this.props.onPrevClick}):e.h("div",{className:"q-slider__arrow q-slider__arrow_prev",onClick:this.props.onPrevClick});return e.h("div",{className:"q-slider__navigation"},s,t)},s}(i.Component),f=function(t){function s(){t.apply(this,arguments)}return t&&(s.__proto__=t),(s.prototype=Object.create(t&&t.prototype)).constructor=s,s.prototype.getAdjustedSlidesForPagination=function(){return this.props.slides.slice(0,this.props.slides.length-this.props.slidesToShow+1)},s.prototype.renderPaginationItem=function(t,s){var r=this,n={key:t,className:o("q-slider__pagination-item",{"q-slider__pagination-item_is-current":s}),onClick:function(e){return r.props.onPaginationItemClick(e,t)}};return this.props.paginationItem?i.cloneElement(this.props.paginationItem,n):e.h("div",n)},s.prototype.render=function(){var t=this;return e.h("div",{className:"q-slider__pagination"},this.getAdjustedSlidesForPagination.bind(this)().map(function(e,i){return t.renderPaginationItem(i,i===t.props.currentSlide)}))},s}(i.Component),S=s.connect(["slides","currentSlide"])(f),g=function(t){function i(){t.call(this),this.gotoNext=this.gotoNext.bind(this),this.gotoPrev=this.gotoPrev.bind(this),this.gotoSlide=this.gotoSlide.bind(this),this.canMove=this.canMove.bind(this)}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.componentWillMount=function(){this.slider=null,this.autoplayPaused=!1,this.autoplayCycle=null,this.lastAuoplayCycleStart=0,this.remainingAutoplayCycleDuration=0,this.isWaitingForCallback=!0,this.setMaxSlideOffset()},i.prototype.componentWillUnmount=function(){this.stopAutoplay()},i.prototype.componentDidUpdate=function(t){!t.autoplay&&this.props.autoplay?this.startAutoplay():t.autoplay&&!this.props.autoplay&&this.stopAutoplay(),this.setMaxSlideOffset()},i.prototype.componentDidMount=function(){if(this.props.children.length>0)this.setState({renderChildren:!0}),this.props.setSlides(this.props.children);else if(this.props.slidesHTML){var t=r.PreactHTMLConverter().convert(this.props.slidesHTML);this.props.setSlides(t.length?t:[t])}!0===this.props.autoplay&&this.startAutoplay()},i.prototype.checkGotoSlideProp=function(){null!==this.props.gotoSlide&&this.gotoSlide(this.props.gotoSlide)},i.prototype.startAutoplay=function(){this.runAutoplayCycle(this.remainingAutoplayCycleDuration>0&&this.remainingAutoplayCycleDuration<this.props.autoplaySpeed?this.remainingAutoplayCycleDuration:this.props.autoplaySpeed)},i.prototype.stopAutoplay=function(){this.remainingAutoplayCycleDuration=(new Date).getTime()-this.lastAuoplayCycleStart,clearTimeout(this.autoplayCycle)},i.prototype.runAutoplayCycle=function(t){var e=this;void 0===t&&(t=1e3),this.autoplayCycle=setTimeout(function(){e.lastAuoplayCycleStart=(new Date).getTime(),e.runAutoplayCycle(t),e.handleNextClick()},t)},i.prototype.setMaxSlideOffset=function(){this.maxSlideOffset=this.props.slides.length-this.props.slidesToShow},i.prototype.canGoPrev=function(){return this.props.currentSlide>0},i.prototype.canGoNext=function(){return this.props.currentSlide<this.maxSlideOffset},i.prototype.canMove=function(){return!this.props.isFading&&(!1!==this.isWaitingForCallback&&!1!==this.props.canMove())},i.prototype.gotoNext=function(){var t,e=this;this.canMove()&&(t=this.props.currentSlide+this.props.slidesToScroll<=this.maxSlideOffset?this.props.slidesToScroll:this.props.rewindOnEnd&&this.props.currentSlide===this.maxSlideOffset?-1*this.props.currentSlide:this.maxSlideOffset-this.props.currentSlide,this.props.beforeChange()&&this.props.beforeChange().then?(this.isWaitingForCallback=!1,this.props.beforeChange().then(function(){e.props.setCurrentSlide(e.props.currentSlide+t),e.isWaitingForCallback=!0})):this.props.setCurrentSlide(this.props.currentSlide+t))},i.prototype.gotoPrev=function(){var t,e=this;this.canMove()&&(t=this.props.currentSlide-this.props.slidesToScroll>=0?this.props.slidesToScroll:this.props.rewindOnEnd&&0===this.props.currentSlide?-1*this.maxSlideOffset:this.props.currentSlide,this.props.beforeChange()&&this.props.beforeChange().then?(this.isWaitingForCallback=!1,this.props.beforeChange().then(function(){e.props.setCurrentSlide(e.props.currentSlide-t),e.isWaitingForCallback=!0})):this.props.setCurrentSlide(this.props.currentSlide-t))},i.prototype.gotoSlide=function(t,e){var i=this;if(void 0===e&&(e=!1),this.canMove()){var s;if(s=t<0?this.props.fade?this.maxSlideOffset:0:t>this.maxSlideOffset?this.props.fade?0:this.maxSlideOffset:t,e)return s;this.props.beforeChange()&&this.props.beforeChange().then?(this.isWaitingForCallback=!1,this.props.beforeChange().then(function(){i.props.setCurrentSlide(s),i.isWaitingForCallback=!0})):this.props.setCurrentSlide(s)}},i.prototype.handlePrevClick=function(){(this.props.slides.length>=this.props.slidesToShow&&this.props.rewindOnEnd||this.canGoPrev())&&this.gotoPrev()},i.prototype.handleNextClick=function(){(this.props.slides.length>=this.props.slidesToShow&&this.props.rewindOnEnd||this.canGoNext())&&this.gotoNext()},i.prototype.handlePaginationItemClick=function(t,e){this.props.slides.length<this.props.slidesToShow||this.gotoSlide(e)},i.prototype.getSliderWidth=function(){return this.slider.getBoundingClientRect().width},i.prototype.handleSliderRef=function(t){this.slider=t},i.prototype.render=function(){return this.props.slides.length>0&&e.h("div",{className:o("q-slider__slider",{"q-slider__slider_is-vertical":this.props.vertical,"q-slider__slider_no-sliding":this.props.slides.length<=this.props.slidesToShow}),ref:this.handleSliderRef.bind(this)},e.h(h,{vertical:this.props.vertical,getSliderWidth:this.getSliderWidth.bind(this),slidesToScroll:this.props.slidesToScroll,slidesToShow:this.props.slidesToShow,gotoSlide:this.gotoSlide},e.h(c,{vertical:this.props.vertical,fade:this.props.fade,slidesToShow:this.props.slidesToShow,fadeDuration:this.props.fadeDuration,onSlideClick:this.props.onSlideClick})),this.props.showArrows&&this.props.slides.length>1&&e.h(u,{onNextClick:this.handleNextClick.bind(this),onPrevClick:this.handlePrevClick.bind(this),nextArrow:this.props.nextArrow,prevArrow:this.props.prevArrow}),this.props.showPagination&&this.props.slides.length>1&&e.h(S,{onPaginationItemClick:this.handlePaginationItemClick.bind(this),slidesToShow:this.props.slidesToShow}))},i}(i.Component);g.defaultProps={slidesToShow:1,slidesToScroll:1,fade:!1,fadeDuration:500,showArrows:!0,showPagination:!0,autoplay:!1,autoplaySpeed:1e3,onSlideClick:function(){},canMove:function(){},beforeChange:function(){}};var y=s.connect(["slides","isGrabbing","currentSlide","grabbedTrackOffset","isFading"],p)(g),v={slides:[],isGrabbing:!1,grabbedTrackOffset:0,lastSlide:0,currentSlide:0,isFading:!1},b=Object.assign||function(t){for(var e=arguments,i=1;i<arguments.length;i++){var s=e[i];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o])}return t},C=function(t){function i(e){t.call(this,e);var i=b({},e,{slidesToScroll:e.fade?1:e.slidesToScroll,slidesToShow:e.fade?1:e.slidesToShow});this.state={ready:!1,initialProps:b({},i),currentProps:i}}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.componentDidMount=function(){this.watchBreakpoints()},i.prototype.componentWillReceiveProps=function(t){this.setState({initialProps:Object.assign(this.state.initialProps,t),currentProps:Object.assign(this.state.currentProps,t)})},i.prototype.watchBreakpoints=function(){var t=this;if(this.props.breakpoints){var e=function(e,i){e.matches&&t.setState({currentProps:Object.assign(t.state.currentProps,null!==i?i:t.state.initialProps)})},i=function(t,i){var s=window.matchMedia(t);s.addListener(function(t){return e(t,i)}),e(s,i)},s=-1;Object.keys(this.props.breakpoints).sort(function(t,e){return t-e}).forEach(function(e,o){i("(min-width: "+(parseInt(s)+1)+"px) and (max-width: "+e+"px)",t.props.breakpoints[e]),s=e}),i("(min-width: "+(parseInt(s)+1)+"px)",null)}this.setState({ready:!0})},i.prototype.render=function(){return this.state.ready&&e.h(s.Provider,{store:n(v)},e.h(y,this.state.currentProps,this.props.children))},i}(i.Component);module.exports=C;
